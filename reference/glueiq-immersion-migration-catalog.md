# GlueIQ Immersion - Migration Catalog

> **Purpose:** Comprehensive inventory of the glueiq-immersion app to inform migration into a clean GlueOS monorepo generated by the Component Library generator.
>
> **Source repo:** https://github.com/GlueIQ/glueiq-immersion
> **Analyzed:** 2026-02-18

---

## 1. Project Overview

GlueIQ Immersion is an AI-powered client research and opportunity mapping platform. It features a 9-lens analytical framework, 14 competitive analysis tools, an AI copilot, coaching/prompt management, and multi-format export.

---

## 2. Core Framework & Runtime

| Technology | Version | Notes |
|------------|---------|-------|
| **Next.js** | 16.1.6 | App Router, Server & Client Components |
| **React** | 19.2.3 | |
| **React DOM** | 19.2.3 | |
| **TypeScript** | ^5 | Strict mode, ES2017 target |
| **Node.js** | 18+ (implied) | Not explicitly specified |
| **Package Manager** | npm | package-lock.json (v3) |

### Next.js Configuration
- `transpilePackages`: none
- Image optimization: remote patterns for `img.clerk.com`
- No standalone output mode
- No custom webpack config

---

## 3. Styling & UI System

| Technology | Version | Notes |
|------------|---------|-------|
| **Tailwind CSS** | ^4 | v4 with PostCSS plugin (`@tailwindcss/postcss`) |
| **tw-animate-css** | ^1.4.0 | Animation utilities |
| **shadcn/ui** | New York style | Configured via `components.json` |
| **class-variance-authority** | ^0.7.1 | Component variants |
| **clsx** | ^2.1.1 | Conditional classnames |
| **tailwind-merge** | ^3.4.0 | Class deduplication |
| **lucide-react** | ^0.563.0 | Primary icon library |
| **@heroicons/react** | ^2.2.0 | Secondary icon library |
| **next-themes** | ^0.4.6 | Dark/light mode |

### shadcn/ui Components (24)
accordion, alert-dialog, avatar, badge, button, card, checkbox, dialog, dropdown-menu, input, label, popover, progress, radio-group, select, sheet, skeleton, switch, table, tabs, textarea, tooltip

### Radix UI Primitives (16)
@radix-ui/react-accordion, alert-dialog, avatar, checkbox, dialog, dropdown-menu, label, popover, progress, radio-group, select, slot, switch, tabs, tooltip

---

## 4. Authentication & Identity

| Service | Package | Version |
|---------|---------|---------|
| **Clerk** (primary) | @clerk/nextjs | ^6.37.1 |
| **Clerk themes** | @clerk/themes | ^2.4.51 |
| **Azure MSAL** (Teams) | @azure/msal-node | ^5.0.3 |

### Auth Flow
- Clerk handles sign-in/sign-up, session management, user profiles
- Domain-restricted to `@glueiq.com`
- Azure AD used only for Microsoft Teams integration (client credentials flow)
- All protected routes extract `userId` via `await auth()`
- Permission checks: `canViewImmersion()`, `canEditImmersion()`

---

## 5. Database & Storage

| Service | Package | Version | Purpose |
|---------|---------|---------|---------|
| **Supabase** | @supabase/supabase-js | ^2.93.3 | Primary database (PostgreSQL) |
| **Airtable** | airtable | ^0.12.2 | Backup/fallback storage, feedback |

### Supabase Tables
- **`immersions`** — Main immersion records (full JSON state)
- **`LensData`** — Collected data points per lens (linked to immersion_id)

### Airtable Tables
- **`Immersions`** — Backup immersion storage
- **`LensData`** — Backup lens data
- **`Feedback`** — User feedback submissions

---

## 6. External API Integrations (12 services)

### AI
| Service | Package/Method | Purpose |
|---------|---------------|---------|
| **Anthropic Claude** | @anthropic-ai/sdk ^0.72.1 | Lens analysis, executive summaries, AI copilot, text assistance |
| Model | claude-sonnet-4-20250514 | Primary model used |

### Web Data & Scraping
| Service | Method | Purpose |
|---------|--------|---------|
| **Firecrawl** | REST API (`lib/firecrawl.ts`) | Web scraping, batch scraping, site crawling |
| **Bright Data** | REST API (`lib/brightdata.ts`) | Social mentions, LinkedIn, Glassdoor, Yelp, YouTube, TikTok ads, Google Maps |
| **SemRush** | REST API (`lib/semrush.ts`) | SEO keywords, traffic, backlinks, paid media, competitors, display ads |
| **SerpAPI** | REST API (`lib/serpapi.ts`) | Google Trends data |
| **SearchAPI.io** | REST API (`lib/searchapi.ts`) | Google News, Meta/TikTok/LinkedIn ads search |

### Financial
| Service | Method | Purpose |
|---------|--------|---------|
| **Alpha Vantage** | REST API (`lib/alpha-vantage.ts`) | Stock quotes, company overview, financials, earnings |
| **SEC EDGAR** | REST API (`lib/sec-edgar.ts`) | SEC filings lookup |

### Advertising
| Service | Method | Purpose |
|---------|--------|---------|
| **Meta Ad Library** | Graph API v19.0 (`lib/meta-ads.ts`) | Facebook/Instagram ad search |

### Collaboration
| Service | Method | Purpose |
|---------|--------|---------|
| **Microsoft Teams** | Graph API v1.0 (`lib/teams.ts`) | Teams/channels/messages, file upload, webhooks |

---

## 7. Data Fetching & State

| Technology | Version | Purpose |
|------------|---------|---------|
| **SWR** | ^2.3.8 | Client-side data fetching & caching |
| **React Context** | (built-in) | ImmersionContext for global state |
| **localStorage** | (built-in) | Conversation history, selected immersion |
| **sessionStorage** | (built-in) | Tools hub session state |

---

## 8. Export & Document Generation

| Package | Version | Purpose |
|---------|---------|---------|
| **@react-pdf/renderer** | ^4.3.2 | PDF generation |
| **pptxgenjs** | ^4.0.1 | PowerPoint generation |
| **docx** | ^9.5.1 | Word document generation |
| **file-saver** | ^2.0.5 | Client-side file downloads |

### Export Formats
- PDF (via HTML print-to-PDF with GlueIQ branding)
- PPTX (slide-based analysis exports)
- DOCX (Word document reports)

---

## 9. Charts & Visualization

| Package | Version |
|---------|---------|
| **recharts** | ^3.7.0 |

### Chart Components (42 specialized components)

**Gauges & Scorecards:** SentimentGauge, AuthorityGauge, VisibilityRadarChart, AIPresenceScorecard

**Matrices:** CompetitiveMatrix, OpportunityMatrix, LocalCompetitorGrid, PlatformDominanceGrid

**Bar Charts:** VisibilityRankingBars, LinkQualityBars, ShareBars, TrafficComparisonBars, SpendComparison

**Distributions:** RatingDistribution, RegionalBreakdown, VoiceBreakdown, ThemeAnalysis, KeywordDistributionChart

**Trends:** TrendTimeline, LensProgressChart, TrafficTrendChart

**Intelligence:** MentionFeed, QuestionMining, QuickWinCards, RisingOpportunities, GapAnalysis, KeywordVenn, KeywordROIMatrix, OpportunityRadar

**Specialty:** MarketPodium, LocalRankingCard, CreativeGallery, AdPreviewCards, ConsumerIntentCards, BrandComparisonChart, TrendsHeroModule

---

## 10. Date & Utility Libraries

| Package | Version | Purpose |
|---------|---------|---------|
| **date-fns** | ^4.1.0 | Date formatting/manipulation |

---

## 11. Application Architecture

### Route Structure
```
app/
├── page.tsx                              # Redirect to /immersions
├── sign-in/[[...sign-in]]/page.tsx       # Clerk sign-in
├── sign-up/[[...sign-up]]/page.tsx       # Clerk sign-up
├── (authenticated)/
│   ├── layout.tsx                        # Shell + ImmersionProvider
│   ├── immersions/
│   │   ├── page.tsx                      # Immersions hub (grid)
│   │   ├── new/page.tsx                  # Create immersion (intake form)
│   │   └── [id]/page.tsx                 # Immersion detail (analysis view)
│   ├── ask/page.tsx                      # AI copilot chat
│   ├── coaching/page.tsx                 # Prompt management
│   ├── settings/page.tsx                 # User/team settings
│   └── tools/
│       ├── page.tsx                      # Tools hub
│       ├── ai-visibility/page.tsx
│       ├── organic-traffic/page.tsx
│       ├── paid-media/page.tsx
│       ├── sentiment/page.tsx
│       ├── keyword-gap/page.tsx
│       ├── share-of-voice/page.tsx
│       ├── backlinks/page.tsx
│       ├── trends/page.tsx
│       ├── geography/page.tsx
│       ├── ad-creative/page.tsx
│       ├── financial-picture/page.tsx
│       ├── local-reach/page.tsx
│       └── news/page.tsx
└── api/
    ├── immersions/                       # CRUD + collect + analyze + export
    ├── tools/                            # 14 tool endpoints
    ├── prompts/                          # Prompt CRUD + seed + improve
    ├── ask/                              # AI copilot
    ├── ai-assist/                        # Text assistance
    ├── teams/                            # Microsoft Teams integration
    ├── feedback/                         # Feedback CRUD
    ├── social/                           # Social data queries
    └── admin/                            # Migration utilities
```

### API Routes (45+ endpoints)

**Immersion Management:** Create, list, get, update, delete, collect, analyze, analyze-lens, export, status

**Tools (14):** keyword-gap, organic-traffic, paid-media, backlinks, sentiment, ad-creative, financial-picture, ai-visibility, share-of-voice, geography, local-reach, news, trends + financial search

**Prompts:** CRUD, seed defaults, AI improve, add-ons

**AI:** /ask (copilot chat), /ai-assist (text expand/improve/generate)

**Teams:** List teams, create team, list channels, create channel, get/post messages, upload files, share

**Other:** feedback, social, page-descriptions, admin/migrate

### Component Count
- **Immersion components:** 26
- **Chart components:** 42
- **Tool analyzer components:** 24+
- **Coaching components:** 4
- **UI primitives (shadcn):** 24
- **Layout/Shell:** 3
- **Feedback/Settings:** 3
- **Total:** ~130 components

---

## 12. Type System

### Core Types (`types/immersion.ts`)

**Immersion Status Flow:**
```
draft → intake_complete → collecting → analyzing → review → complete
                                                      ↓
                                                    error
```

**9 Analytical Lenses (LensId):**
| ID | Name | Category |
|----|------|----------|
| b1 | Business Today | client |
| b2 | Business Tomorrow | client |
| p | People/Politics | client |
| s | State of Now | consumer |
| t1 | Tech Disruption (Consumer) | consumer |
| v | Value Segmentation | consumer |
| tr | Current Trends | market |
| t2 | Tech Disruption (Market) | market |
| c | Competitive Set | market |

**Key Interfaces:** Immersion, Lens, DataPoint, Insight, Competitor, LensConfig

---

## 13. Library / Service Files (`lib/`)

| File | Lines (est.) | Purpose |
|------|-------------|---------|
| supabase.ts | 450+ | Database CRUD |
| semrush.ts | 600+ | SEO/SEM API client |
| alpha-vantage.ts | 350+ | Financial data |
| brightdata.ts | 300+ | Social & business data |
| meta-ads.ts | 290 | Meta Ads Library |
| firecrawl.ts | 224 | Web scraping |
| searchapi.ts | 200+ | Multi-platform search |
| claude.ts | 200+ | AI analysis |
| chatService.ts | 200+ | AI copilot orchestration |
| serpapi.ts | 150+ | Google Trends |
| teams.ts | 200+ | Microsoft Teams |
| airtable.ts | 150+ | Airtable backup |
| sec-edgar.ts | ~100 | SEC filings |
| export.ts | — | Basic export |
| export-enhanced.ts | — | Enhanced HTML export |
| pdf-generator.tsx | — | PDF components |
| toolResultTransformer.ts | — | Tool data → insights |
| toolExport.ts | — | Tool result export |
| chatExport.ts | — | Chat history export |
| lenses.ts | — | Lens configuration |
| prompt-defaults.ts | — | Default prompts |
| utils.ts | — | cn() utility |

---

## 14. Environment Variables Required (17)

### Core Services
| Variable | Service |
|----------|---------|
| `ANTHROPIC_API_KEY` | Claude AI |
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase |
| `FIRECRAWL_API_KEY` | Web scraping |
| `BRIGHTDATA_TOKEN` | Social & business data |
| `SEMRUSH_API_KEY` | SEO analysis |
| `SERPAPI_KEY` | Google Trends |
| `SEARCHAPI_KEY` | Multi-platform search |
| `ALPHA_VANTAGE_API_KEY` | Financial data |
| `META_ACCESS_TOKEN` | Meta Ads Library |

### Authentication
| Variable | Service |
|----------|---------|
| `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY` | Clerk |
| `CLERK_SECRET_KEY` | Clerk |
| `AZURE_AD_CLIENT_ID` | Teams |
| `AZURE_AD_CLIENT_SECRET` | Teams |
| `AZURE_AD_TENANT_ID` | Teams |

### Optional
| Variable | Service |
|----------|---------|
| `AIRTABLE_API_KEY` | Airtable backup |
| `AIRTABLE_BASE_ID` | Airtable base |

---

## 15. Migration Considerations

### What maps to GlueOS monorepo structure
| Current Location | Monorepo Target |
|-----------------|-----------------|
| `components/ui/*` | `packages/ui/` (already in GlueOS) |
| `components/*` (app-specific) | `apps/web/components/` |
| `app/(authenticated)/*` | `apps/web/app/` |
| `app/api/*` | `apps/web/app/api/` |
| `lib/*` | `apps/web/lib/` or `packages/services/` |
| `types/*` | `packages/types/` or `apps/web/types/` |
| `contexts/*` | `apps/web/contexts/` |
| `hooks/*` | `apps/web/hooks/` |
| `public/*` | `apps/web/public/` |

### Key Decisions Needed
1. **Tailwind v4 vs v3** — GlueOS Component Library uses Tailwind v3; Immersion uses v4. Align on one.
2. **Package manager** — Immersion uses npm; GlueOS uses pnpm. Migrate to pnpm.
3. **shadcn/ui components** — Many overlap with `@repo/ui`. Deduplicate into shared package.
4. **Auth** — Clerk is app-specific, keep in `apps/web`.
5. **External API clients** — Could become a shared `packages/services` package if reused.
6. **Chart components** — 42 charts are app-specific; keep in `apps/web/components/charts/`.
7. **Supabase** — App-specific database; keep connection in `apps/web/lib/`.
8. **Airtable** — Evaluate if still needed or can be fully replaced by Supabase.

### Potential Shared Packages
- `@scope/ui` — shadcn/ui primitives (already exists in GlueOS)
- `@scope/types` — Shared TypeScript types
- `@scope/services` — External API clients (if reused across apps)

### Port Range (per convention)
Assign a unique port range for this workspace per the GlueOS port convention documented in `DOCKER.md`.
